PL/SQL Developer Report

[SQL]
SELECT * FROM (
WITH SAL AS(
SELECT FY,CUSTOMERID,ORGNAME||' - '||ADDRESS CUSTOMERNAME,ORGNAME,ADDRESS,REGIONNAME,COMPPORD,COMPANY_ID,PRODUCTID,NOTE
,SUM(JAN2017) AS JAN2017,SUM(JAN2018) AS JAN2018
,SUM(FEB2017) AS FEB2017,SUM(FEB2018) AS FEB2018
,SUM(MAR2017) AS MAR2017,SUM(MAR2018) AS MAR2018
,SUM(APR2017) AS APR2017,SUM(APR2018) AS APR2018
,SUM(MAY2017) AS MAY2017,SUM(MAY2018) AS MAY2018
,SUM(JUN2017) AS JUN2017,SUM(JUN2018) AS JUN2018
,SUM(JUL2017) AS JUL2017,SUM(JUL2018) AS JUL2018
,SUM(AUG2017) AS AUG2017,SUM(AUG2018) AS AUG2018
,SUM(SEP2017) AS SEP2017,SUM(SEP2018) AS SEP2018
,SUM(OCT2017) AS OCT2017,SUM(OCT2018) AS OCT2018
,SUM(NOV2017) AS NOV2017,SUM(NOV2018) AS NOV2018
,SUM(DEC2017) AS DEC2017,SUM(DEC2018) AS DEC2018
FROM(
SELECT TO_CHAR(D.TRANSDATE,'YYYY') AS FY,M.CUSTOMERID,C.ORGNAME,C.ADDRESS,R.REGIONNAME,D.COMPPORD,D.COMPANY_ID,D.PRODUCTID,C.NOTE,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),01,D.SALE_QTY*P.UNITPRICE,0) AS JAN2017,
0 AS JAN2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),02,D.SALE_QTY*P.UNITPRICE,0) AS FEB2017,
0 AS FEB2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),03,D.SALE_QTY*P.UNITPRICE,0) AS MAR2017,
0 AS MAR2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),04,D.SALE_QTY*P.UNITPRICE,0) AS APR2017,
0 AS APR2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),05,D.SALE_QTY*D.UNIT_PRICE,0) AS MAY2017,
0 AS MAY2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),06,D.SALE_QTY*P.UNITPRICE,0) AS JUN2017,
0 AS JUN2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),07,D.SALE_QTY*P.UNITPRICE,0) AS JUL2017,
0 AS JUL2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),08,D.SALE_QTY*P.UNITPRICE,0) AS AUG2017,
0 AS AUG2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),09,D.SALE_QTY*P.UNITPRICE,0) AS SEP2017,
0 AS SEP2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),10,D.SALE_QTY*P.UNITPRICE,0) AS OCT2017,
0 AS OCT2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),11,D.SALE_QTY*P.UNITPRICE,0) AS NOV2017,
0 AS NOV2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),12,D.SALE_QTY*P.UNITPRICE,0) AS DEC2017,
0 AS DEC2018
 FROM SALE_DETAIL D,SALE_MASTER M,CUSTOMERS C,REGION R,PRODUCTS P
  WHERE M.TRANSNO=D.TRANSNO
    AND M.CUSTOMERID=C.CUSTOMERID
    AND D.COMPANY_ID=&COMP
    AND TRUNC(D.TRANSDATE) BETWEEN &PRV_F_DATE AND &PRV_T_DATE

AND C.REGIONID=R.REGIONID
AND D.COMPANY_ID=P.COMPANY_ID
AND D.PRODUCTID=P.PRODUCTID
----RETURN
UNION ALL
SELECT TO_CHAR(D.TRANSDATE,'YYYY') AS FY,M.CUSTOMERID,C.ORGNAME,C.ADDRESS,R.REGIONNAME,D.COMPPORD,D.COMPANY_ID,D.PRODUCTID,C.NOTE,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),01,D.SALE_QTY*P.UNITPRICE,0)*-1 AS JAN2017,
0 AS JAN2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),02,D.SALE_QTY*P.UNITPRICE,0)*-1 AS FEB2017,
0 AS FEB2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),03,D.SALE_QTY*P.UNITPRICE,0)*-1 AS MAR2017,
0 AS MAR2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),04,D.SALE_QTY*P.UNITPRICE,0)*-1 AS APR2017,
0 AS APR2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),05,D.SALE_QTY*D.UNIT_PRICE,0)*-1 AS MAY2017,
0 AS MAY2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),06,D.SALE_QTY*P.UNITPRICE,0)*-1 AS JUN2017,
0 AS JUN2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),07,D.SALE_QTY*P.UNITPRICE,0)*-1 AS JUL2017,
0 AS JUL2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),08,D.SALE_QTY*P.UNITPRICE,0)*-1 AS AUG2017,
0 AS AUG2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),09,D.SALE_QTY*P.UNITPRICE,0)*-1 AS SEP2017,
0 AS SEP2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),10,D.SALE_QTY*P.UNITPRICE,0)*-1 AS OCT2017,
0 AS OCT2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),11,D.SALE_QTY*P.UNITPRICE,0)*-1 AS NOV2017,
0 AS NOV2018,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),12,D.SALE_QTY*P.UNITPRICE,0)*-1 AS DEC2017,
0 AS DEC2018
 FROM RETURN_DETAIL D,RETURN_MASTER M,CUSTOMERS C,REGION R,PRODUCTS P
  WHERE M.TRANSNO=D.TRANSNO
    AND M.CUSTOMERID=C.CUSTOMERID
    AND D.COMPANY_ID=&COMP
    AND TRUNC(D.TRANSDATE) BETWEEN &PRV_F_DATE AND &PRV_T_DATE

AND C.REGIONID=R.REGIONID
AND D.COMPANY_ID=P.COMPANY_ID
AND D.PRODUCTID=P.PRODUCTID

-----2018
UNION ALL
SELECT TO_CHAR(D.TRANSDATE,'YYYY') AS FY,M.CUSTOMERID,C.ORGNAME,C.ADDRESS,R.REGIONNAME,D.COMPPORD,D.COMPANY_ID,D.PRODUCTID,C.NOTE,
0 AS JAN2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),01,D.SALE_QTY*P.UNITPRICE,0) AS JAN2018,
0 AS FEB2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),02,D.SALE_QTY*P.UNITPRICE,0) AS FEB2018,
0 AS MAR2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),03,D.SALE_QTY*P.UNITPRICE,0) AS MAR2018,
0 AS APR2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),04,D.SALE_QTY*P.UNITPRICE,0) AS APR2018,
0 AS MAY2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),05,D.SALE_QTY*D.UNIT_PRICE,0) AS MAY2018,
0 AS JUN2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),06,D.SALE_QTY*P.UNITPRICE,0) AS JUN2018,
0 AS JUL2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),07,D.SALE_QTY*P.UNITPRICE,0) AS JUL2018,
0 AS AUG2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),08,D.SALE_QTY*P.UNITPRICE,0) AS AUG2018,
0 AS SEP2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),09,D.SALE_QTY*P.UNITPRICE,0) AS SEP2018,
0 AS OCT2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),10,D.SALE_QTY*P.UNITPRICE,0) AS OCT2018,
0 AS NOV2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),11,D.SALE_QTY*P.UNITPRICE,0) AS NOV2018,
0 AS DEC2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),12,D.SALE_QTY*P.UNITPRICE,0) AS DEC2018
 FROM SALE_DETAIL D,SALE_MASTER M,CUSTOMERS C,REGION R,PRODUCTS P
  WHERE M.TRANSNO=D.TRANSNO
    AND M.CUSTOMERID=C.CUSTOMERID
        AND D.COMPANY_ID=&COMP
    AND TRUNC(D.TRANSDATE) BETWEEN &CUR_F_DATE AND &CUR_T_DATE

AND C.REGIONID=R.REGIONID
AND D.COMPANY_ID=P.COMPANY_ID
AND D.PRODUCTID=P.PRODUCTID
---RETURN
UNION ALL
SELECT TO_CHAR(D.TRANSDATE,'YYYY') AS FY,M.CUSTOMERID,C.ORGNAME,C.ADDRESS,R.REGIONNAME,D.COMPPORD,D.COMPANY_ID,D.PRODUCTID,C.NOTE,
0 AS JAN2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),01,D.SALE_QTY*P.UNITPRICE,0)*-1 AS JAN2018,
0 AS FEB2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),02,D.SALE_QTY*P.UNITPRICE,0)*-1 AS FEB2018,
0 AS MAR2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),03,D.SALE_QTY*P.UNITPRICE,0)*-1 AS MAR2018,
0 AS APR2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),04,D.SALE_QTY*P.UNITPRICE,0)*-1 AS APR2018,
0 AS MAY2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),05,D.SALE_QTY*D.UNIT_PRICE,0)*-1 AS MAY2018,
0 AS JUN2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),06,D.SALE_QTY*P.UNITPRICE,0)*-1 AS JUN2018,
0 AS JUL2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),07,D.SALE_QTY*P.UNITPRICE,0)*-1 AS JUL2018,
0 AS AUG2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),08,D.SALE_QTY*P.UNITPRICE,0)*-1 AS AUG2018,
0 AS SEP2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),09,D.SALE_QTY*P.UNITPRICE,0)*-1 AS SEP2018,
0 AS OCT2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),10,D.SALE_QTY*P.UNITPRICE,0)*-1 AS OCT2018,
0 AS NOV2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),11,D.SALE_QTY*P.UNITPRICE,0)*-1 AS NOV2018,
0 AS DEC2017,
DECODE(TO_CHAR(D.TRANSDATE,'MM'),12,D.SALE_QTY*P.UNITPRICE,0)*-1 AS DEC2018
 FROM RETURN_DETAIL D,RETURN_MASTER M,CUSTOMERS C,REGION R,PRODUCTS P
  WHERE M.TRANSNO=D.TRANSNO
    AND M.CUSTOMERID=C.CUSTOMERID
        AND D.COMPANY_ID=&COMP
    AND TRUNC(D.TRANSDATE) BETWEEN &CUR_F_DATE AND &CUR_T_DATE

AND C.REGIONID=R.REGIONID
AND D.COMPANY_ID=P.COMPANY_ID
AND D.PRODUCTID=P.PRODUCTID

)
 GROUP BY FY,CUSTOMERID,ORGNAME,ADDRESS,ADDRESS,REGIONNAME,COMPPORD,COMPANY_ID,PRODUCTID,NOTE),

 COMP AS ( SELECT  C.COMPANY_ID,C.COMPANY_ID||' - '||C.COMPANY_NAME COMPANY_NAME,G.GROUPID,G.GROUPNAME,P.PRODUCTID,P.PRODNAME
            FROM COMPANY C,PRODUCTS P,COMPGROUPS G
                WHERE C.COMPANY_ID=P.COMPANY_ID
                  AND P.COMPANY_ID=G.COMPNAY_ID
                   AND P.GROUPID=G.GROUPID
                   AND NVL(P.MAXALLOW,0)=1
     )

 SELECT S.CUSTOMERID,S.ORGNAME,S.NOTE AS OLDID,ADDRESS,S.REGIONNAME,SUM(S.JAN2017) AS JAN2017,SUM(S.JAN2018) AS JAN2018,SUM(S.FEB2017) AS FEB2017,SUM(S.FEB2018) AS FEB2018
 ,SUM(S.MAR2017) AS MAR2017,SUM(S.MAR2018) AS MAR2018,SUM(S.APR2017) AS APR2017,SUM(S.APR2018) AS APR2018
 ,SUM(S.MAY2017) AS MAY2017 ,SUM(S.MAY2018) AS MAY2018
 ,SUM(S.JUN2017) AS JUN2017  ,SUM(S.JUN2018) AS JUN2018
  ,SUM(S.JUL2017) AS JUL2017,SUM(S.JUL2018) AS JUL2018
  ,SUM(S.AUG2017) AS AUG2017  ,SUM(S.AUG2018) AS AUG2018
  ,SUM(S.SEP2017) AS SEP2017,SUM(S.SEP2018) AS SEP2018
  ,SUM(S.OCT2017) AS OCT2017,SUM(S.OCT2018) AS OCT2018
  ,SUM(S.NOV2017) AS NOV2017,SUM(S.NOV2018) AS NOV2018
  ,SUM(S.DEC2017) AS DEC2017,SUM(S.DEC2018) AS DEC2018

 FROM SAL S,COMP C
   WHERE S.COMPANY_ID=C.COMPANY_ID
     AND S.PRODUCTID=C.PRODUCTID 
  ----  AND C.GROUPID = NVL(:GRPID,C.GROUPID) 
GROUP BY S.CUSTOMERID,S.ORGNAME,S.NOTE,ADDRESS,REGIONNAME
ORDER BY 1
);

[Options]
Connect=False
Username=
Password=2469
Database=
ConnectAs=
LockMode=0
LockedPassword=2120
BkgColor=-16777211
BkgImage=
FormLayout=False
OnlyNBSP=False
LeftMargin=0
TopMargin=0
PageBreak=0
AddSQL=False
HandleTags=True

[Styles]

{Title}
Enabled=True
Name=Report Title
Description=
Style=
HeaderStyle=
Align=0
Break=0
Function=0
Format=

{Param}
Enabled=True
Name=Variables
Description=
Style=
HeaderStyle=
Align=0
Break=0
Function=0
Format=

{Table}
Enabled=True
Name=Tabular Tables
Description=
Style=
HeaderStyle=
Align=0
Break=0
Function=0
Format=

{Form}
Enabled=True
Name=Form Tables
Description=
Style=
HeaderStyle=
Align=0
Break=0
Function=0
Format=

{Field}
Enabled=True
Name=Default Field
Description=
Style=
HeaderStyle=
Align=0
Break=0
Function=0
Format=



[CSS]


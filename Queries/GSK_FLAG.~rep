SELECT PRODNAME,GSK_FLAG,SUM(SALE_QTY) SALE_QTY  
 FROM ( SELECT PRODNAME,CUSTOMERS.GSK_FLAG,SUM(SALE_QTY) SALE_QTY   
    --INTO S
    FROM CUSTOMERS, SALE_DETAIL, SALE_MASTER,PRODUCTS
    WHERE (SALE_DETAIL.TRANSTYPE = SALE_MASTER.TRANSTYPE
    AND SALE_DETAIL.TRANSDATE = SALE_MASTER.TRANSDATE
    AND SALE_DETAIL.TRANSNO = SALE_MASTER.TRANSNO
    AND SALE_DETAIL.UNITNO = SALE_MASTER.UNITNO
    AND SALE_DETAIL.COMPCODE = SALE_MASTER.COMPCODE)
    AND SALE_DETAIL.COMPANY_ID=PRODUCTS.COMPANY_ID
    AND SALE_DETAIL.PRODUCTID=PRODUCTS.PRODUCTID
    AND (SALE_MASTER.COMPCODE = CUSTOMERS.COMPCODE
    AND SALE_MASTER.UNITNO = CUSTOMERS.UNITNO
    AND SALE_MASTER.CUSTOMERID = CUSTOMERS.CUSTOMERID) 
    AND SALE_DETAIL.COMPANY_ID = &COMPANY_ID 
    AND SALE_DETAIL.PRODUCTID = &PRODUCTID
    AND SALE_MASTER.TRANSDATE BETWEEN &F_DATE AND &T_DATE
    --AND CUSTOMERS.GSK_FLAG = 'Wholesale'
    AND SALE_DETAIL.COMPCODE = &COMPCODE 
    AND SALE_DETAIL.UNITNO = &UNITNO
    GROUP BY PRODNAME,CUSTOMERS.GSK_FLAG
    UNION ALL
    ------ RETURN
    SELECT PRODNAME,CUSTOMERS.GSK_FLAG,SUM(SALE_QTY)*-1 SALE_QTY  
    --INTO R
    FROM CUSTOMERS, RETURN_DETAIL, RETURN_MASTER,PRODUCTS
    WHERE (RETURN_DETAIL.TRANSTYPE = RETURN_MASTER.TRANSTYPE
    AND RETURN_DETAIL.TRANSDATE = RETURN_MASTER.TRANSDATE
    AND RETURN_DETAIL.TRANSNO = RETURN_MASTER.TRANSNO
    AND RETURN_DETAIL.UNITNO = RETURN_MASTER.UNITNO
    AND RETURN_DETAIL.COMPCODE = RETURN_MASTER.COMPCODE)
      AND RETURN_DETAIL.COMPANY_ID=PRODUCTS.COMPANY_ID
    AND RETURN_DETAIL.PRODUCTID=PRODUCTS.PRODUCTID
    AND (RETURN_MASTER.COMPCODE = CUSTOMERS.COMPCODE
    AND RETURN_MASTER.UNITNO = CUSTOMERS.UNITNO
    AND RETURN_MASTER.CUSTOMERID = CUSTOMERS.CUSTOMERID) 
    AND RETURN_DETAIL.COMPANY_ID = &COMPANY_ID 
    AND RETURN_DETAIL.PRODUCTID = &PRODUCTID
    AND RETURN_MASTER.TRANSDATE BETWEEN &F_DATE AND &T_DATE
    --AND CUSTOMERS.GSK_FLAG = 'Wholesale'
    AND RETURN_DETAIL.COMPCODE = &COMPCODE 
    AND RETURN_DETAIL.UNITNO = &UNITNO
    GROUP BY PRODNAME,CUSTOMERS.GSK_FLAG)
   GROUP BY PRODNAME,GSK_FLAG 
   ORDER BY 1,2;
